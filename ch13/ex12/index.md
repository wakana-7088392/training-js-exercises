## 以下のコードを実行すると何が出力されるか予想し実際に確認しなさい。また「タスク」について調査し、この用語を用いて理由を説明しなさい。

# 予想

- 何も出力されない。「Hello, world!」が出力されない。
  - awaitで永続的に待機状態が続くから？

# 実行結果

- 何も出力されない。
  - 15秒ほど待ったが何も出力されなかった。

# 理由

- マイクロタスクに該当するawaitの処理を持つlongRunningButAsyncFunctionが無限ループを起こし、その無限ループがマイクロタスクキューに新しいタスクを追加し続けることでマイクロタスクキューが空にならないから。
- 流れ
  - setTimeoutのタイマーが実行され、コールバック関数(「Hello, world!」をログ出力する処理)がマクロタスクキューに追加される。
  - longRunningButAsyncFunctionの無限ループ内でawaitが実行される。awaitはマイクロタスクキューに積まれる。このawaitはnullをawaitしているのですぐに解決される。
  - しかし、無限ループによってawait nullがマイクロタスクキューに積まれ続ける。
  - マイクロタスクキューが空にならないため、マクロタスクキューにあるsetTimeoutのコールバック関数が実行されなくなる。

# メモ

- マイクロタスク
  - 現在のタスクが完了した直後に実行されるタスクのこと。マクロタスクの間に挟まる形で実行されるため、マクロタスクが先に積まれている場合でも先に実行される。
  - awaitはマイクロタスクに該当し、「コード中(非同期関数でもモジュールでも)でawaitが発生すると、待機中の式が実行され、式の値に依存するすべてのコードは一時停止してマイクロタスクキューに入れられ」るとのこと(参考サイトより引用)。

# 参考サイト

- [await-JavaScript|MDN](https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Operators/await)
