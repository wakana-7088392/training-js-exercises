# ch15.11-15/ex16

## オリジン間リソース共有（CORS）について、以下の問いに答えなさい。

### クロスオリジンリクエストに制約が無かった場合、どのような問題が発生するか述べなさい

- そもそもCORSとは
    - ブラウザが異なるオリジン(ドメイン、プロトコル、ポート)からリソースをリクエストする際のセキュリティ機構。

- どのような問題が発生するの？
    - 悪意のあるウェブサイトが、ユーザーの認証情報を使って他のサイトにリクエストを送り、機密情報を取得することができてしまい、クロスサイトリクエストフォージェリ（CSRF）攻撃が発生しやすくなるから。
        - CSRF：利用者が意図したリクエストかどうかを識別する仕組みを持たないがゆえに外部サイトを経由した悪意あるリクエストを受け入れてしまい、利用者が予期しない処理を実行させられてしまう問題のこと
        - これにより、ログイン認証が必要なウェブサイトでログイン後利用者のみが利用可能なサービス(送金、商品購入、退会)が悪用されてしまったり、ログイン後の利用者のみが編集可能な情報の改ざん(パスワードなどの各種設定の不正な変更)などが行われる可能性がある。


### クロスオリジンリクエストで メソッド(POST/GET)やリクエストの内容によって Preflight リクエストの有無が異なるのは何故か、その理由を述べなさい

- そもそもpreflightとは
    - CORSのリクエストの一つ
    - サーバーがCORSプロトコルを理解して準備がされていることを、特定のメソッドとヘッダーを使用してチェックする

- 必要なものとそうでないもの
    - シンプルリクエストか否か

- なぜなのか
    - セキュリティとパフォーマンスのバランスをとるため
        - 複雑なリクエストの場合はリスクが高まるのでセキュリティを予め担保しておきたいから。逆に複雑なものではない場合(シンプルリクエスト)はリスクが低い(CORSで対応できる)と考えられるため、必要性がないらしい。
    - データが大きい場合はPriflightで予め通信を許可するか否かを判別するほうが処理が速くなる、というメリットがあるから。大きいデータをやり取りする前に判別することで、通信できない場合は早く拒否することができる。


### 参考リンク
- [IPA 1.6CSRF(クラスサイト・リクエスト・フォージェリ)](https://www.ipa.go.jp/security/vuln/websecurity/csrf.html)
- [MDN Preflight request](https://developer.mozilla.org/ja/docs/Glossary/Preflight_request)
- [CORSとは何ですか？](https://aws.amazon.com/jp/what-is/cross-origin-resource-sharing/)